<!DOCTYPE html>
<html>
<head>
    <title>Invoice #{{ order.id }}</title>
    <style>
        @page {
            size: a4 portrait;
            margin: 1.5cm;
        }

        body {
            font-family: 'Helvetica', 'Arial', sans-serif;
            color: #222;
            line-height: 1.6;
            margin: 0;
        }

        /* Spacing out the header */
        .header-container {
            display: table;
            width: 100%;
            margin-bottom: 50px;
        }
        .logo-cell { display: table-cell; vertical-align: top; }
        .company-cell { display: table-cell; text-align: right; vertical-align: top; }

        .logo { width: 140px; }
        .company-cell h1 {
            color: #d96a00;
            margin: 0 0 5px 0;
            font-size: 32px;
            letter-spacing: 1px;
        }
        .company-cell p { margin: 2px 0; font-size: 12px; color: #666; }

        /* Meta details with better padding */
        .invoice-meta {
            display: table;
            width: 100%;
            margin-bottom: 40px;
            background-color: #fcfcfc;
            border: 1px solid #efefef;
            border-radius: 8px;
        }
        .meta-box { display: table-cell; padding: 20px; font-size: 13px; width: 50%; }
        .text-right { text-align: right; }

        /* Clean table design */
        .items-table { width: 100%; border-collapse: collapse; margin-bottom: 40px; }
        .items-table th {
            background-color: #f8f9fa;
            font-weight: bold;
            text-transform: uppercase;
            font-size: 11px;
            letter-spacing: 1px;
            padding: 12px 15px;
            border-bottom: 2px solid #333;
        }
        .items-table td { padding: 15px; border-bottom: 1px solid #eee; font-size: 13px; }
        .col-right { text-align: right; }

        /* Totals section alignment */
        .summary-container { display: table; width: 100%; }
        .summary-spacer { display: table-cell; width: 55%; }
        .summary-content { display: table-cell; width: 45%; }

        .totals-table { width: 100%; border-collapse: collapse; }
        .totals-table td { padding: 8px 0; font-size: 13px; }
        .grand-total {
            font-size: 20px;
            color: #d96a00;
            border-top: 2px solid #d96a00;
        }
        .grand-total td { padding-top: 15px; font-weight: bold; }

        .footer { position: fixed; bottom: 0; left: 0; right: 0; text-align: center; font-size: 11px; color: #999; border-top: 1px solid #eee; padding-top: 10px; }
    </style>
</head>
<body>
<div class="header-container">
    <div class="logo-cell">
        <img src="file://C:/Users/USER/Desktop/sellux_plaster/static/images/logo.png" class="logo" alt="Sellux Plaster Ltd">
    </div>
    <div class="company-cell">
        <h1>INVOICE</h1>
        <p><strong>Sellux Plaster Ltd</strong></p>
        <p>Odokor, Dr. Busia Highway, Accra</p>
        <p>selluxplasterltd@gmail.com</p>
    </div>
</div>

<div class="invoice-meta">
    <div class="meta-box">
        <span style="color: #888; text-transform: uppercase; font-size: 10px; font-weight: bold;">Billed To</span><br>
        <div style="margin-top: 5px; font-size: 15px; font-weight: bold;">{{ order.first_name }} {{ order.last_name }}</div>
        {{ order.email }}
    </div>
    <div class="meta-box text-right">
        <span style="color: #888; text-transform: uppercase; font-size: 10px; font-weight: bold;">Details</span><br>
        <div style="margin-top: 5px;"><strong>Invoice #:</strong> {{ order.id }}</div>
        <strong>Date:</strong> {{ order.created_at|date:"d M Y" }}
    </div>
</div>

<table class="items-table">
    <thead>
    <tr>
        <th style="text-align: left;">Item Description</th>
        <th class="col-right">Qty</th>
        <th class="col-right">Unit Price</th>
        <th class="col-right">Total</th>
    </tr>
    </thead>
    <tbody>
    {% for item in order.items.all %}
    <tr>
        <td><strong>{{ item.product.name }}</strong></td>
        <td class="col-right">{{ item.quantity }}</td>
        <td class="col-right"><span style="font-size: 10px; color: #888;">GHS</span> {{ item.price|floatformat:2 }}</td>
        <td class="col-right"><strong><span style="font-size: 10px; color: #888;">GHS</span> {{ item.get_cost|floatformat:2 }}</strong></td>
    </tr>
    {% endfor %}
    </tbody>
</table>

<div class="summary-container">
    <div class="summary-spacer"></div>
    <div class="summary-content">
        <table class="totals-table">
            <tr>
                <td>Subtotal</td>
                <td class="col-right">GHS {{ order.total_amount|floatformat:2 }}</td>
            </tr>
            <tr>
                <td>Tax</td>
                <td class="col-right">GHS {{ order.tax|floatformat:2 }}</td>
            </tr>
            <tr>
                <td>Delivery</td>
                <td class="col-right">GHS {{ order.delivery_fee|floatformat:2 }}</td>
            </tr>
            <tr class="grand-total">
                <td>TOTAL</td>
                <td class="col-right">GHS {{ order.get_grand_total|floatformat:2 }}</td>
            </tr>
        </table>
    </div>
</div>

<div class="footer">
    <p>Thank you for choosing Sellux Plaster Ltd for your architectural needs.</p>
</div>
</body>
</html>